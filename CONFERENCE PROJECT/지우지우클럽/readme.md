# ìˆ˜ì œë²„ê±° ì¶”ì²œ ì‹œìŠ¤í…œ ğŸ”
## Preview
<img width="612" alt="image" src="https://github.com/KU-BIG/KUBIG_2024_SPRING/assets/109716683/1629855b-25a6-4db6-8224-62e06df12eec">

[ìˆ˜ì œë²„ê±° ì¶”ì²œì‹œìŠ¤í…œ ë§í¬](https://app-burgertest.streamlit.app/)

## Role
- **ë°•ì„¸í›ˆ**: í˜‘ì—… í•„í„°ë§ ì‹œìŠ¤í…œ êµ¬í˜„(ALS)
- **ì´ìŠ¹ì¤€**: ì£¼ì œ ì„ ì • ë° êµ¬ì²´í™”, ë©”ë‰´ ë°ì´í„° ì „ì²˜ë¦¬, í¬ìŠ¤í„° ìµœì¢… ìˆ˜í•©
- **ì„ì§€ìš°**: streamlit êµ¬í˜„, PPT ìµœì¢… ìˆ˜í•©
- **ìµœì£¼í¬**: ë°ì´í„° í¬ë¡¤ë§, ë¦¬ë·° ë°ì´í„° ì „ì²˜ë¦¬
- **ìµœì§€ìš°**: ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§ ì‹œìŠ¤í…œ êµ¬í˜„(ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê¸°ë°˜)
---
## í”„ë¡œì íŠ¸ ë°°ê²½ ë° í•„ìš”ì„±
### Problem
í”„ë¦¬ë¯¸ì—„ ìˆ˜ì œë²„ê±°ì— ëŒ€í•œ í•œêµ­ì¸ì˜ ì§€ì†ì ì´ê³  ëœ¨ê±°ìš´ ê´€ì‹¬ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í”„ë¦¬ë¯¸ì—„ ìˆ˜ì œë²„ê±° ì‹œì¥ì´ ì»¤ì§€ê³  ìˆ˜ìš”ê°€ ìƒê²¨ë‚˜ê³  ìˆìœ¼ë‚˜ ì‚¬ëŒë“¤ì˜ ì·¨ì‹ ê²½í—˜ì€ ì €ê°€í˜• í”„ëœì°¨ì´ì¦ˆ ë²„ê±°ì— ë¨¸ë¬¼ëŸ¬ ìˆë‹¤. ì´ëŸ° ìƒí™© ì†ì—ì„œ **ë³¸ì¸ì˜ ì·¨í–¥ì— ë§ëŠ” ë²„ê±° ê°€ê²Œ, ë©”ë‰´ë¥¼ ì„ íƒí•¨ì— ìˆì–´ ì–´ë ¤ì›€ì„ ê²ªëŠ”ë‹¤.**

### Solution
ìœ ì €ì˜ ì €ê°€í˜• í”„ëœì°¨ì´ì¦ˆ ë²„ê±° ì·¨ì‹ê²½í—˜ì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ **ì·¨í–¥ì— ë§ëŠ” í”„ë¦¬ë¯¸ì—„ ë²„ê±° ê°€ê²Œ ë° ë©”ë‰´ë¥¼ ì¶”ì²œí•´ì¤€ë‹¤.** 

## Dataset
### Data Crawling
- ë©”ë‰´ ë°ì´í„°: ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§ì— ì‚¬ìš©
  - ì €ê°€í˜• ë¸Œëœë“œ ë²„ê±°: ê°€ê²Œ ì´ë¦„, ë©”ë‰´ ì´ë¦„, ê°€ê²©, í•œ ì¤„ ì„¤ëª…, ì¬ë£Œ 
  - í”„ë¦¬ë¯¸ì—„ ìˆ˜ì œ ë²„ê±°: ê°€ê²Œ ì´ë¦„, í‰ì , ìœ„ì¹˜, ë°©ë¬¸ì ë¦¬ë·° ìˆ˜, ë¸”ë¡œê·¸ ë¦¬ë·° ìˆ˜, ë©”ë‰´ ì´ë¦„, ê°€ê²©, í•œ ì¤„ ì„¤ëª…, ì¬ë£Œ(ì „ì²˜ë¦¬ë¡œ ì œì‘)
- ë¦¬ë·° ë°ì´í„°: í˜‘ì—… í•„í„°ë§ì— ì‚¬ìš©
  - ê°€ê²Œ ì´ë¦„, ìœ ì € ì´ë¦„, ìœ ì € ì‹ë³„ì •ë³´(ë¦¬ë·° ìˆ˜, ì‚¬ì§„ ìˆ˜, íŒ”ë¡œì›Œ ìˆ˜), ë³„ì , ë°©ì‹(ì˜ˆì•½, ëŒ€ê¸°ì‹œê°„, ëª©ì , ë™í–‰ì¸), ë¦¬ë·° ë‚´ìš©, í‚¤ì›Œë“œ, ë°©ë¬¸ ë‚ ì§œ, ë°©ë¬¸ íšŸìˆ˜

### Preprocessing
**ë©”ë‰´ ë°ì´í„°**
1. ê¸°ë³¸ ë°ì´í„° ì „ì²˜ë¦¬: 'ë²„ê±°ê°€ ì•„ë‹Œ ë©”ë‰´' ë° 'ì„¸íŠ¸ ë©”ë‰´' ì œê±°
2. í˜•íƒœì†Œ ë¶„ë¦¬: KoNLPy ì‚¬ìš©, ë²„ê±° ë„ë©”ì¸ì— ë§ëŠ” ë¶ˆìš©ì–´ ë° ì˜ˆì™¸ ë‹¨ì–´ ì‚¬ì „ êµ¬ì¶•, í–„ë²„ê±° ì„¤ëª… ë¬¸ì¥ ê°„ì˜ ìœ ì‚¬ë„ ë¹„êµë¥¼ ìœ„í•¨
3. íŒ¨í‹° ì—´ ìƒì„±: GPT 4.0 í”„ë¡¬í”„íŒ…. ì†Œê³ ê¸° íŒ¨í‹°, ìƒˆìš° íŒ¨í‹° ë“± ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§ ì‹œ 1ì°¨ êµ¬ë¶„ì„ ìœ„í•¨
4. ìœ„ê²½ë„ ê°’ ì¶”ì¶œ: ì£¼ì†Œ ë°ì´í„°ì— ê¸°ë°˜í•´ ë²„ê±° ê°€ê²Œ ìœ„ê²½ë„ ì¶”ì¶œ, ê²°ê³¼ êµ¬í˜„ ì‹œ UI ë‚´ ê°€ê²Œ ì •ë³´ ë…¸ì¶œì„ ìœ„í•¨


**ë¦¬ë·° ë°ì´í„°**
1. ì¤‘ë³µê°’ ì²˜ë¦¬: ìœ ì € ì •ë³´ë¡œ groupbyí–ˆì„ ë•Œ ë™ì¼í•œ ì‚¬ëŒì´ ë‹¤ë¥¸ ì‚¬ëŒìœ¼ë¡œ ì¸ì‹ë˜ëŠ” ê²½ìš° ì „ì²˜ë¦¬
2. ë¦¬ë·° í…ìŠ¤íŠ¸ ì²˜ë¦¬: ì´ëª¨í‹°ì½˜ ë° íŠ¹ìˆ˜ë¬¸ì ì œê±°
     

## Model Structure
<img width="1115" alt="image" src="https://github.com/KU-BIG/KUBIG_2024_SPRING/assets/109716683/a5ef0386-13ea-4e83-b8e2-84d4909e7c17">

### ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§(cosine similarity)
- TF-IDFë¡œ ë‹¨ì–´ ì„ë² ë”© ì§„í–‰
- ë²¡í„°í™”ëœ ì•„ì´í…œì— ëŒ€í•´ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ í–‰ë ¬ ìƒì„±
- ìœ ì‚¬ë„ ê¸°ë°˜ ì¶”ì²œ ì´ì „ì— ê°€ê²©ì˜ min, max ê°’ ì„¤ì • + ë™ì¼ íŒ¨í‹°ë§Œ ì¶”ì²œë˜ë„ë¡ ì„¤ì •

**=> ì„ íƒí•œ í”„ëœì°¨ì´ì¦ˆ ë²„ê±°ì™€ ê°€ì¥ ìœ ì‚¬í•œ ìƒìœ„ 5ê°œ ìˆ˜ì œë²„ê±° ì¶”ì²œ**
```python
# wordlist ì—´ì„ TF-IDF ë²¡í„°í™”
tfidf_vectorizer = TfidfVectorizer(tokenizer=lambda x: x.split(' '))
tfidf_matrix = tfidf_vectorizer.fit_transform(burger_data['wordlist'])


# ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê³„ì‚°
cosine_sim = cosine_similarity(tfidf_matrix, tfidf_matrix)

# ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ DataFrameìœ¼ë¡œ ë³€í™˜í•˜ì—¬ í™•ì¸
similarity_df = pd.DataFrame(cosine_sim, index=burger_data['menu'], columns=burger_data['menu'])
similarity_df.head()

# ìµœì¢… ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§ ì§„í–‰
filtered_recommendations = recommendations_df[
        (recommendations_df['class'] == 1) &
        (recommendations_df['price'] >= min) &
        (recommendations_df['price'] < max) &
        ((recommendations_df['visitor'] + recommendations_df['blog']) >= popularity_min) &
        (recommendations_df['patty'].str.contains(selected_burger_patty, na = False))
  ]

  filtered_recommendations = filtered_recommendations.drop_duplicates(subset='menu')

  # ìµœì¢… ì¶”ì²œ ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ì—¬ ìƒìœ„ 5ê°œ ì¶”ì²œ í™•ì¸
  final_recommendations = filtered_recommendations[['id', 'menu', 'name', 'price', 'score']].set_index('menu').sort_values(by='score', ascending=False).iloc[1:11]
  return final_recommendations
```

### í˜‘ì—… í•„í„°ë§(ALS)
ì‚¬ìš©ìì™€ ì•„ì´í…œì˜ ì ì¬ í–‰ë ¬ì„ ìˆœì°¨ì ìœ¼ë¡œ ìµœì í™”í•˜ëŠ” matrix factorizationì¸ ALS(Alternating Least Squares)ì„ ì‚¬ìš©í•˜ì—¬ 1ìˆœìœ„ë¡œ ì¶”ì²œëœ ë²„ê±°ê°€ ì†í•œ ë ˆìŠ¤í† ë‘ê³¼ ê°€ì¥ ìœ ì‚¬í•œ ë²„ê±°ì§‘ 5ê°œë¥¼ ì¶”ê°€ë¡œ ì¶”ì²œ. 

```python
# ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°
train = pd.read_csv('1ì°¨ ë¦¬ë·° ì „ì²˜ë¦¬(ì›ë³¸).csv')
train = train[['username','restaurant']]
train.columns = ['user_id', 'rest_id']

# ë°ì´í„° <--> ì¸ë±ìŠ¤ êµí™˜ ë”•ì…”ë„ˆë¦¬
user2idx = {}
for i, l in enumerate(train['user_id'].unique()):
    user2idx[l] = i
    
rest2idx = {}
for i, l in enumerate(train['rest_id'].unique()):
    rest2idx[l] = i

idx2user = {}
for i, l in enumerate(train['user_id'].unique()):
    idx2user[i] = l

idx2rest = {}
for i, l in enumerate(train['rest_id'].unique()):
    idx2rest[i] = l

# ì¸ë±ìŠ¤ ìƒì„±
data = train.copy()
useridx = data['useridx'] = train['user_id'].apply(lambda x: user2idx[x]).values
restidx = data['restidx'] = train['rest_id'].apply(lambda x: rest2idx[x]).values
rating = np.ones(len(data))

# í¬ì†Œ í–‰ë ¬(csr_matrix)
purchase_sparse = scipy.sparse.csr_matrix((rating, (useridx, restidx)), shape=(len(set(useridx)), len(set(restidx))))
# ALS ëª¨ë¸ ì´ˆê¸°í™”
als_model = ALS(factors=40, regularization=0.01, iterations=50)
# ëª¨ë¸ ìµœì í™”
als_model.fit(purchase_sparse, show_progress=False)
    related = als_model.similar_items(rest2idx[unique_names[0]])
```
